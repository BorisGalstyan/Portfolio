import httpx
import json

# Mock responses for demo (replace with real API)
MODULE_PROMPTS = {
    "jurist": {"name": "Юридический навигатор", "prompts": ["Составь договор аренды", "Проверь договор на риски", "Объясни права в ситуации X", "Напиши претензию", "Анализ изменений в законе"]},
    "auto": {"name": "Автопомощник", "prompts": ["Диагностика по звуку", "График ТО", "Подбор запчастей", "Расчёт владения авто", "Документы для регистрации"]},
    "pc": {"name": "ПК-помощник", "prompts": ["Медленная работа ПК", "Настройка Wi-Fi", "Выбор ноутбука", "Удаление вируса", "Резервное копирование"]},
    "home": {"name": "Дом-мастер", "prompts": ["Починить кран", "График работ по дому", "Выбор стиралки", "Засор канализации", "Система хранения"]},
    "med": {"name": "Мед-переводчик", "prompts": ["Опиши симптомы терапевту", "Объясни диагноз", "Вопросы врачу", "Правила приёма лекарств", "Расшифровка назначений"]}
}

async def get_ai_response(module_id: str, user_msg: str, template: str = "") -> str:
    # Real: httpx.post("https://api.yagpt or gigachat", json={"prompt": f"Ты {MODULE_PROMPTS[module_id]['name']}. {template or ''} User: {user_msg}"})
    mock_responses = {
        "jurist": "По российскому ГК РФ договор аренды должен включать срок, оплату, ответственность. Шаблон: ...",
        "auto": "По звуку — возможно подшипник. Рекомендую ТО через 5000 км.",
        "pc": "Очистите кэш, обновите драйверы. Инструкция шаг 1: ...",
        "home": "Для крана: закрутите гайку, замените прокладку. Инструменты: ...",
        "med": "Симптомы: перевод 'головная боль + тошнота' = cephalalgia + nausea."
    }
    return mock_responses.get(module_id, "AI ответ по теме") + f" (на основе '{user_msg}')"

def get_module_prompts(module_id: str) -> dict:
    return MODULE_PROMPTS.get(module_id, {})
